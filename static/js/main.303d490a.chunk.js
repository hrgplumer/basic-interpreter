(this["webpackJsonpbasic-interpreter"]=this["webpackJsonpbasic-interpreter"]||[]).push([[0],[,,,,function(t,e,n){t.exports=n(12)},,,,,function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){"use strict";n.r(e);var i=n(0),r=n.n(i),s=n(3),a=n.n(s),h=(n(9),n(1));function o(t,e){this.text=t,this.type=e,this.toString=function(){return"["+this.text+","+this.type+"]"},this.getType=function(){return this.type},this.getText=function(){return this.text}}function c(t){return"number"===typeof t||"boolean"===typeof t}function u(t){return" "===t||"\t"===t||"\v"===t||"\f"===t}function l(t){return t>="0"&&t<="9"}function f(t,e){if(10===e)return t>="0"&&t<="9";if(8===e)return t>="0"&&t<="7";if(16===e){var n=t.toUpperCase();return t>="0"&&t<="9"||n>="A"&&n<="F"}return!1}function p(t){return t>="A"&&t<="Z"||t>="a"&&t<="z"}function d(t){return p(t)||l(t)}function E(t){this.error=!1,this.tokens=new Array,this.current_token=0,this.last_token=null,this.reset=function(){this.current_token=0},this.hasMoreTokens=function(){return this.current_token<this.tokens.length},this.nextToken=function(){return this.tokens[this.current_token++]},this.lastToken=function(){return this.last_token},this.currentToken=function(){return this.tokens[this.current_token]},this.addToken=function(t){this.tokens[this.tokens.length]=t},this.isError=function(){return this.error},this.tokenize=function(){var e=/^(IF|THEN|ELSE|FOR|TO|STEP|GOTO|GOSUB|RETURN|NEXT|INPUT|LET|CLS|END|PRINT|DIM|DATA|READ|REM|END|OR|AND|MOD|WHILE|WEND|RANDOMIZE|SYSTEM|KEY|CLEAR)$/i,n=/^(VAL|STR\$|LEFT\$|RIGHT\$|MID\$|LEN|RND|INT|INSTR|ABS|ASC|CHR\$|SQR|STRING\$|SIN|COS|TAN|TIMER)$/i,i=0;for(this.error=!1;i<t.length;){var r,s=t[i];if(r=i+1<t.length?t[i+1]:-1,"."!==s)if(l(s)){for(T=i;i<t.length&&l(s);)i++,s=t[i];if(i<t.length&&"."===s)for(i++,s=t[i];i<t.length&&l(s);)i++,s=t[i];else if(i<t.length&&"E"===s&&(i++,s=t[i],i<t.length&&("+"===s||"-"===s)))for(i++,s=t[i];i<t.length&&l(s);)i++,s=t[i];_=t.substring(T,i);"#"!==s&&"!"!==s||i++;c=new o(_,"NUMBER");this.addToken(c)}else if("&"!==s)if(p(s)){for(T=i;i<t.length&&d(s);)i++,s=t[i];"$"!==s&&"!"!==s&&"#"!==s&&"%"!==s||i++;var a=t.substring(T,i),h=a.match(e);c=h&&h[0]?"OR"===(m=a.toUpperCase())||"AND"===m?new o(m,"LOGICAL_OPERATOR"):"MOD"===m?new o(m,"MULT_OPERATOR"):new o(a.toUpperCase(),"KEYWORD"):(h=a.match(n))&&h[0]?new o(a.toUpperCase(),"FUNCTION"):new o(a,"IDENTIFIER"),this.addToken(c)}else if('"'!==s)if(u(s))for(;i<t.length&&u(s);)i++,s=t[i];else if("*"!==s&&"/"!==s&&"^"!==s&&"\\"!==s)if("("!==s)if(")"!==s)if("+"!==s&&"-"!==s)if("'"!==s)if(":"!==s)if(","!==s&&";"!==s)if("="!==s)if(">"!==s&&"<"!==s)if("\r"!==s&&"\n"!==s){c=new o(s,"CHARACTER");this.addToken(c),i++}else{i++,"\r"===s&&"\n"===r&&i++;c=new o("--","ENDOFLINE");this.addToken(c)}else i++,"<"===s&&">"===r?(i++,c=new o("<>","RELATIONAL")):"="===r?(i++,c=new o(s+"=","RELATIONAL")):c=new o(s,"RELATIONAL"),this.addToken(c);else{i++;c=new o(s,"ASSIGNMENT");this.addToken(c)}else{i++;c=new o(s,"DELIMITER");this.addToken(c)}else{i++;c=new o(s,"STATEMENT_DELIMITER");this.addToken(c)}else{i++;c=new o(s,"COMMENT");this.addToken(c)}else{i++;var c=new o(s,"PLUS_OPERATOR");this.addToken(c)}else{i++;var c=new o(s,"CLOSEPAREN");this.addToken(c)}else{i++;var c=new o(s,"OPENPAREN");this.addToken(c)}else{i++;var c=new o(s,"MULT_OPERATOR");this.addToken(c)}else{T=i;if(++i>=t.length){this.error=!0;break}for(s=t[i];i<t.length&&'"'!=s;)i++,s=t[i];if('"'!=s){this.error=!0;break}i++;var E=t.substring(T,i),c=new o(E.substring(1,E.length-1),"STRING");this.addToken(c)}else{var R=8,T=i+1;for("H"===r.toUpperCase()?(R=16,i+=2,T++):"O"===r.toUpperCase()&&(i+=2,T++),s=i<t.length?t[i]:-1;i<t.length&&f(s,R);)i++,s=t[i];_=t.substring(T,i);var m,c=new o((m=parseInt(_,R)).toString(),"NUMBER");this.addToken(c)}else{var T=i;for(i++,s=t[i];i<t.length&&l(s);)i++,s=t[i];var _,c=new o(_=t.substring(T,i),"NUMBER");this.addToken(c)}}if(this.error)throw"ERROR: "+this.error},this.toString=function(){for(var t="current token: "+this.current_token+"\n",e=0;e<this.tokens.length;e++)t+="<"+e+"> "+this.tokens[e].toString(),t+="\n";return t},this.acceptText=function(t){if(!this.hasMoreTokens())return!1;var e=this.tokens[this.current_token];return e.getText().toUpperCase()===t.toUpperCase()&&(this.last_token=e,this.nextToken(),!0)},this.will_acceptText=function(t){return!!this.hasMoreTokens()&&this.tokens[this.current_token].getText().toUpperCase()===t.toUpperCase()},this.unaccept=function(t){this.current_token>0&&this.current_token--},this.will_accept=function(t){return!!this.hasMoreTokens()&&this.tokens[this.current_token].getType()===t},this.accept=function(t){if(!this.hasMoreTokens())return!1;var e=this.tokens[this.current_token];return e.getType()===t&&(this.last_token=e,this.nextToken(),!0)},this.expect=function(t){if(!this.accept(t)){if(!this.hasMoreTokens())throw"Error: expected '"+t+"' but end of token found";throw"Error: expected '"+t+"' but "+this.tokens[this.current_token].getType()+" found"}},this.tokenize()}function R(t){this.linenumber=t,this.statements=new Array,this.setStatements=function(t){this.statements=t},this.toString=function(){for(var t="[ LINE# "+this.linenumber+"] ",e=0;e<this.statements.length;e++){t+="ST >> "+this.statements[e].toString()}return t+="[END OF LINE# "+this.linenumber+"]"}}function T(t,e){this.type=t,this.text=e,this.children=new Array,this.getText=function(){return this.text},this.getType=function(){return this.type},this.addChild=function(t){this.children[this.children.length]=t},this.toString=function(t){void 0===t&&(t=0);for(var e="",n=0;n<t;n++)e+=" ";var i=e+"TYPE = <"+this.type+"> ";void 0!==this.text&&(i+="TEXT = "+this.text),i+="\n";for(n=0;n<this.children.length;n++)i+=this.children[n].toString(t+1);return i+="\n"}}function m(t){this.name=t,this.value=null,this.bounds=null,this.mult=null,this.setBounds=function(e){this.value=new Array,this.bounds=new Array,this.mult=new Array;for(var n,i=1,r=0;r<e.length;r++)this.bounds[r]=e[r]+1,this.mult[r]=i,i*=this.bounds[r];n="$"===t[t.length-3]?"":0;for(r=0;r<i;r++)this.value[r]=n},this.getDimension=function(){return null===this.bounds?0:this.bounds.length},this.compute_pos=function(t){for(var e=0,n=0;n<t.length;n++)e+=t[n]*this.mult[n];return e},this.inBounds=function(t){if(t.length!=this.bounds.length)return!1;for(var e=0;e<t.length;e++)if(t[e]<0||t[e]>=this.bounds[e])return!1;return!0},this.setValue=function(t,e){void 0!==e?this.value[this.compute_pos(e)]=t:this.value=t},this.getValue=function(t){return void 0===t?this.value:this.value[this.compute_pos(t)]}}function _(t){this.seed=t,this.x0=t,void 0===t&&(this.seed=(new Date).getTime(),this.x0=this.seed),this.setSeed=function(t){this.seed=t,this.x0=t},this.random=function(){return this.x0=(214013*this.x0+2531011)%(1<<24),this.x0/(1<<24)}}var v=[function(t){this.text=t,this.lines=new Array,this.statements=new Array,this.label_index=new Array,this.expand_if=function(t,e,n,i){if("GOTO"!==e.children[1].getType())if("GOSUB"!==e.children[1].getType()){var r=i+"_"+n,s=r+"_TRUE",a=r+"_FALSE",h=r+"_DONE",o=new T("IF");o.addChild(e.children[0]),o.addChild(new T("GOTO",s)),3===e.children.length?o.addChild(new T("GOTO",a)):o.addChild(new T("GOTO",h)),t.push(o),t.push(new T("LINENUMBER",s));for(var c=e.children[1],u=0;u<c.children.length;u++)t.push(c.children[u]);if(3===e.children.length){t.push(new T("GOTO",h));var l=e.children[2];t.push(new T("LINENUMBER",a));for(u=0;u<l.children.length;u++)t.push(l.children[u])}t.push(new T("LINENUMBER",h))}else t.push(e);else t.push(e)},this.flatten=function(){for(var t=0;t<this.lines.length;t++){var e=this.lines[t];this.statements.push(new T("LINENUMBER",e.linenumber));for(var n=0;n<e.statements.length;n++){"IF"===(i=e.statements[n]).getType()?this.expand_if(this.statements,i,n,t):this.statements.push(i)}}for(t=0;t<this.statements.length;t++){var i;if("LINENUMBER"===(i=this.statements[t]).getType()){if(void 0!==this.label_index[i.getText()])throw"ERROR: duplicate line number "+i.getText();this.label_index[i.getText()]=t}}},this.functions=new Array,this.tokenizer=null,this.accept=function(t){return this.tokenizer.accept(t)},this.will_accept=function(t){return this.tokenizer.will_accept(t)},this.will_acceptText=function(t){return this.tokenizer.will_acceptText(t)},this.hasMoreTokens=function(){return this.tokenizer.hasMoreTokens()},this.acceptText=function(t){return this.tokenizer.acceptText(t)},this.lastText=function(){return this.tokenizer.lastToken().getText()},this.processLine=function(t){var e=new R(parseInt(t.getText()));e.setStatements(this.getStatementsTree()),this.lines[this.lines.length]=e},this.toString=function(){for(var t="***\n",e=0;e<this.lines.length;e++){t+=this.lines[e].toString(),t+="---\n"}return t},this.atom=function(){if(this.accept("NUMBER"))return new T("NUMBER",parseFloat(this.lastText()));if(this.will_accept("IDENTIFIER"))return this.identifier();if(this.will_accept("FUNCTION")){var t=this.identifier();return t.type="FUNCTION",t}if(this.accept("STRING"))return new T("STRING",this.lastText());if(this.accept("OPENPAREN")){var e=this.expression();return this.accept("CLOSEPAREN"),e}var n=this.tokenizer.currentToken();if(void 0===n)throw"ERROR: unexpected end of tokens";throw"ERROR: unexpected token "+n.getType()+" ("+n.getText()+")"},this.unary_expr=function(){var t;return this.acceptText("+")?((t=new T("UNARY_PLUS")).addChild(this.atom()),t):this.acceptText("-")?((t=new T("UNARY_MINUS")).addChild(this.atom()),t):this.atom()},this.mult_expr=function(){for(var t=this.unary_expr();this.accept("MULT_OPERATOR");){var e=new T(this.lastText());e.addChild(t);var n=this.unary_expr();e.addChild(n),t=e}return t},this.plus_expr=function(){for(var t=this.mult_expr();this.accept("PLUS_OPERATOR");){var e=new T(this.lastText());e.addChild(t);var n=this.mult_expr();e.addChild(n),t=e}return t},this.relational=function(){for(var t=this.plus_expr();this.accept("RELATIONAL")||this.acceptText("=");){var e=new T(this.lastText());e.addChild(t);var n=this.plus_expr();e.addChild(n),t=e}return t},this.logical=function(){for(var t=this.relational();this.accept("LOGICAL_OPERATOR");){var e=new T(this.lastText());e.addChild(t);var n=this.relational();e.addChild(n),t=e}return t},this.expression=function(){var t=new T("EXPRESSION"),e=this.logical();return t.addChild(e),t},this.end_of_statement=function(){return!!(this.will_accept("ENDOFLINE")||this.will_accept("STATEMENT_DELIMITER")||this.will_acceptText("ELSE")||this.will_accept("COMMENT"))},this.input_statement=function(t){var e=new T("INPUT"),n="?";t.accept("STRING")&&(n=t.lastText());var i=new T("STRING",n);for(e.addChild(i);t.hasMoreTokens()&&!t.end_of_statement();){if(t.tokenizer.accept("KEYWORD"))throw"ERROR: unexpected keyword "+t.lastText();if(!t.tokenizer.accept("DELIMITER")){var r=t.identifier();e.addChild(r)}}return e},this.identifier=function(){var t=new T("VARIABLE");if(this.accept("IDENTIFIER")||this.accept("FUNCTION"),t.text=this.lastText(),this.accept("OPENPAREN"))for(t.type="ARRAY";this.hasMoreTokens();){var e=this.expression();if(t.addChild(e),!this.acceptText(",")&&this.accept("CLOSEPAREN"))break}return t},this.dim_statement=function(t){var e=new T("DIM");if(t.will_accept("IDENTIFIER")){for(;t.hasMoreTokens();){var n=t.identifier();if(n.type="ARRAY",e.addChild(n),!t.acceptText(",")&&t.end_of_statement())break}return e}throw"ERROR: expected identifer after DIM"},this.get_rest_of_line=function(t){for(;this.hasMoreTokens()&&!this.will_accept("ENDOFLINE");){var e=this.getStatement();t.addChild(e),this.accept("STATEMENT_DELIMITER")}},this.rem_statement=function(t){for(new T("REM");t.hasMoreTokens()&&!t.will_accept("ENDOFLINE");)t.tokenizer.nextToken()},this.goto_statement=function(t){var e=new T("GOTO");if(t.accept("NUMBER"))return e.text=t.lastText(),e;throw"ERROR: GOTO should be followed by number"},this.randomize_statement=function(t){var e=new T("RANDOMIZE");return e.addChild(t.expression()),e},this.gosub_statement=function(t){var e=new T("GOSUB");if(t.accept("NUMBER"))return e.text=t.lastText(),e;throw"ERROR: GOSUB should be followed by number"},this.return_statement=function(t){return new T("RETURN")},this.cls_statement=function(t){return new T("CLS")},this.end_statement=function(t){return new T("END")},this.for_statement=function(t){var e=new T("FOR");if(!t.accept("IDENTIFIER"))throw"ERROR: expected identifier in FOR statement";var n=new T("VARIABLE");if(n.text=t.lastText(),!t.acceptText("="))throw"ERROR: expected = ";e.addChild(n);var i=t.expression();if(!t.acceptText("TO"))throw"ERROR: expected TO in FOR statement ";e.addChild(i);var r=t.expression();if(e.addChild(r),t.acceptText("STEP")){var s=t.expression();e.addChild(s)}return e},this.data_statement=function(t){var e=new T("DATA");if(t.will_accept("NUMBER")||t.will_accept("STRING"))for(;t.hasMoreTokens();){if(t.accept("NUMBER")){var n=t.lastText();c(n)||(n=parseFloat(n)),e.addChild(new T("DATUM",n))}else{if(!t.accept("STRING"))throw"ERROR: unexpected token "+t.lastText();e.addChild(new T("DATUM",t.lastText()))}if(!t.acceptText(","))break}return e},this.read_statement=function(t){for(var e=new T("READ");t.hasMoreTokens()&&!t.end_of_statement();){if(t.tokenizer.accept("KEYWORD"))throw"ERROR: unexpected keyword "+t.lastText();if(!t.tokenizer.accept("DELIMITER")){var n=t.identifier();e.addChild(n)}}return e},this.next_statement=function(t){var e=new T("NEXT");if(t.accept("IDENTIFIER"))for(;t.hasMoreTokens()&&(e.addChild(new T("IDENTIFIER",t.lastText())),t.acceptText(","))&&t.accept("IDENTIFIER"););return e},this.while_statement=function(t){var e=new T("WHILE"),n=t.expression();return e.addChild(n),e},this.wend_statement=function(t){return new T("WEND")},this.clear_statement=function(t){return new T("CLEAR")},this.if_statement=function(t){var e=new T("IF"),n=t.expression();if(e.addChild(n),t.acceptText("THEN")){var i=new T("THEN"),r=null;if(t.will_accept("NUMBER")?(t.accept("NUMBER"),(r=new T("GOTO")).text=t.lastText()):r=t.getStatement(),i.addChild(r),e.addChild(i),t.acceptText("ELSE")){var s=new T("ELSE");if(t.will_accept("NUMBER")){t.accept("NUMBER");var a=new T("GOTO");a.text=t.lastText(),s.addChild(a)}else{var h=t.getStatement();t.accept("STATEMENT_DELIMITER"),s.addChild(h),t.get_rest_of_line(s)}return e.addChild(s),e}return e}if(t.accept("GOTO")){var o=new T("GOTO");if(t.accept("NUMBER")){o.text=t.lastText(),e.addChild(o);var c=new T("_");return t.accept("STATEMENT_DELIMITER"),t.get_rest_of_line(c),e}throw"ERROR: expected NUMBER after GOTO"}throw"ERROR: expected THEN or GOTO in IF statement"},this.print_statement=function(t){for(var e=new T("PRINT");t.hasMoreTokens()&&!t.end_of_statement();){if(t.accept("KEYWORD"))throw"ERROR: unexpected keyword "+t.lastText();if(t.accept("DELIMITER")&&e.addChild(new T("DELIMITER",t.lastText())),t.end_of_statement())break;var n=t.expression();e.addChild(n)}return e},this.key_statement=function(t){var e=new T("KEY");if(t.acceptText("ON")||t.acceptText("OFF"))return e.text=t.lastText(),e;throw"ERROR: only supports KEY ON or KEY OFF"},this.let_statement=function(t){var e=t.identifier();if(t.acceptText("=")){var n=t.expression(),i=new T("ASSIGNMENT");return i.addChild(e),i.addChild(n),i}throw"ERROR: expected '='"},this.getStatement=function(){if(this.accept("KEYWORD")){var t=this.lastText().toUpperCase();if(this.functions[t])return this.functions[t](this)}if(this.accept("COMMENT"))return this.functions.REM(this);if(this.will_accept("IDENTIFIER"))return this.let_statement(this);throw"ERROR: statement error "+this.tokenizer},this.getStatementsTree=function(){if(!this.hasMoreTokens())throw"ERROR: unexpected end of program";for(var t=new Array;this.hasMoreTokens()&&!this.accept("ENDOFLINE");){var e=this.getStatement();if(void 0!==e&&t.push(e),this.accept("STATEMENT_DELIMITER"),this.accept("COMMENT")){for(;this.hasMoreTokens()&&!this.accept("ENDOFLINE");)this.tokenizer.nextToken();break}}return t},this.parse=function(){for(this.tokenizer=new E(t);this.hasMoreTokens();){this.accept("ENDOFLINE");var e=this.tokenizer.nextToken();if(!e||"RUN"!==e.text.toUpperCase()){if("NUMBER"!==e.getType())throw"ERROR: statement must start with line number";this.processLine(e),this.accept("ENDOFLINE")}}this.flatten()},this.functions.PRINT=this.print_statement,this.functions.INPUT=this.input_statement,this.functions.DIM=this.dim_statement,this.functions.IF=this.if_statement,this.functions.GOTO=this.goto_statement,this.functions.GOSUB=this.gosub_statement,this.functions.RETURN=this.return_statement,this.functions.END=this.end_statement,this.functions.SYSTEM=this.end_statement,this.functions.FOR=this.for_statement,this.functions.NEXT=this.next_statement,this.functions.LET=this.let_statement,this.functions.WHILE=this.while_statement,this.functions.WEND=this.wend_statement,this.functions.REM=this.rem_statement,this.functions.CLS=this.cls_statement,this.functions.RANDOMIZE=this.randomize_statement,this.functions.DATA=this.data_statement,this.functions.READ=this.read_statement,this.functions.KEY=this.key_statement,this.functions.CLEAR=this.clear_statement},function(t){this.parser=t,this.ifunctions=new Array,this.stop=!1,this.variables=new Array,this.gosub_stack=new Array,this.for_stack=new Array,this.while_stack=new Array,this.for_info=new Array;var e=!1;function n(t){e&&("undefined"===typeof document?console.debug(t):document.writeln(t))}this.print_function=null,this.number_input_function=null,this.string_input_function=null,this.clear_function=null,this.random=new _,this.last_random=0,this.input_stack=new Array,this.last_point=0,this.data=new Array,this.data_pointer=0,this.push_input=function(t){this.input_stack.push(t)},this.get_array_indices=function(t){for(var e=new Array,n=0;n<t.children.length;n++)e[n]=this.evalExpr(t.children[n]);return e},this.get_next_line=function(t){return t+1},this.ensure_exist=function(t){var e=t.getText();if("ARRAY"===t.getType()){if(e+="[]",void 0===this.variables[e]){var n=new m(e),i=new Array;i[0]=10,n.setBounds(i),this.variables[e]=n}}else if(void 0===this.variables[e]){n=new m(e);this.variables[e]=n,"$"===e[e.length-1]?n.setValue(""):n.setValue(0)}},this.getValue=function(t){var e=t.getText();if(this.ensure_exist(t),"ARRAY"===t.getType()){e+="[]";var n=this.variables[e],i=this.get_array_indices(t);if(!n.inBounds(i))throw"ERROR: subscript out of range";return n.getValue(i)}return(n=this.variables[e]).getValue()},this.setNumericValue=function(t,e){if(void 0===this.variables[t]){var n=new m(t);this.variables[t]=n,n.setValue(e)}(n=this.variables[t]).setValue(e)},this.getNumericValue=function(t,e){if(void 0===this.variables[t]){var i=new m(t);return this.variables[t]=i,i.setValue(0),0}return n("getnumeric '"+t+"' value = "+(i=this.variables[t]).getValue()),i.getValue()},this.setValue=function(t,e){var i=t.getText();if(this.ensure_exist(t),"ARRAY"===t.getType()){n("SET VALUE array "+e),i+="[]";var r=this.variables[i];n("Name = "+i);var s=this.get_array_indices(t);if(!r.inBounds(s))throw"ERROR: subscript out of range";return r.setValue(e,s)}n("SET VALUE "+e),(r=this.variables[i]).setValue(e)},this.expect_param=function(t,e,n){if(void 0===n&&t.children.length!=e)throw"ERROR: function '"+t.text+"' expects "+e+" parameter(s), but got "+t.children.length;if(t.children.length<e||t.children.length>n)throw"ERROR: function '"+t.text+"' expects "+e+" to "+n+"parameters, but got "+t.children.length},this.evalFunction=function(t){var e=t.getText();n("evalfunction "+e+" param count "+t.children.length);var i=t.children.length;switch(e){case"TIMER":return this.expect_param(t,0),new Math.floor((new Date).getTime()/1e3);case"RND":if(this.expect_param(t,0,1),0===i)return this.last_random=this.random.random(),this.last_random;if(c(u=this.evalExpr(t.children[0])))return 0!=u&&(this.last_random=this.random.random()),this.last_random;throw"ERROR: type mismatch for function RND";case"CHR$":if(this.expect_param(t,1),c(f=this.evalExpr(t.children[0])))return String.fromCharCode(f);throw"ERROR: type mismatch for function CHR$";case"STRING$":this.expect_param(t,2);var r=this.evalExpr(t.children[0]);if(c(r)){var s=this.evalExpr(t.children[1]),a="";if(c(s))a=String.fromCharCode(s);else{if(s.length<1)throw"ERROR: illegal function call for STRING$";a=s[0]}for(var h="",o=0;o<r;o++)h+=a;return h}throw"ERROR: type mismatch for function STRING$";case"ASC":if(this.expect_param(t,1),"string"===typeof(f=this.evalExpr(t.children[0])))return f.charCodeAt(0);throw"ERROR: type mismatch for function ASC";case"LEN":if(this.expect_param(t,1),"string"===typeof(f=this.evalExpr(t.children[0])))return f.length;throw"ERROR: type mismatch for function LEN";case"ABS":if(this.expect_param(t,1),c(f=this.evalExpr(t.children[0])))return Math.abs(f);throw"ERROR: type mismatch for function ABS";case"INT":if(this.expect_param(t,1),c(f=this.evalExpr(t.children[0])))return Math.floor(f);throw"ERROR: type mismatch for function INT";case"SIN":if(this.expect_param(t,1),"string"!==typeof(f=this.evalExpr(t.children[0])))return Math.sin(f);throw"ERROR: type mismatch for function SIN";case"SQR":if(this.expect_param(t,1),c(f=this.evalExpr(t.children[0])))return Math.sqrt(f);throw"ERROR: type mismatch for function SQR";case"COS":if(this.expect_param(t,1),c(f=this.evalExpr(t.children[0])))return Math.cos(f);throw"ERROR: type mismatch for function COS";case"TAN":if(this.expect_param(t,1),c(f=this.evalExpr(t.children[0])))return Math.tan(f);throw"ERROR: type mismatch for function TAN";case"VAL":if(this.expect_param(t,1),"string"===typeof(f=this.evalExpr(t.children[0])))return parseFloat(f);throw"ERROR: type mismatch for function VAL";case"STR$":if(this.expect_param(t,1),c(f=this.evalExpr(t.children[0])))return f.toString();throw"ERROR: type mismatch for function STR$";case"LEFT$":if(this.expect_param(t,2),"string"===typeof(f=this.evalExpr(t.children[0])))if(c(u=this.evalExpr(t.children[1])))return f.substring(0,u);throw"ERROR: type mismatch for function LEFT$";case"RIGHT$":if(this.expect_param(t,2),"string"===typeof(f=this.evalExpr(t.children[0])))if(c(u=this.evalExpr(t.children[1])))return f.substring(f.length-u);throw"ERROR: type mismatch for function RIGHT$";case"MID$":var u;if(this.expect_param(t,2,3),"string"===typeof(f=this.evalExpr(t.children[0])))if(c(u=this.evalExpr(t.children[1]))){if(2===i)return f.substring(u);var l=this.evalExpr(t.children[2]);if(c(l))return f.substr(u-1,l)}throw"ERROR: type mismatch for function MID$";case"INSTR":var f;if(this.expect_param(t,2,3),"string"===typeof(f=this.evalExpr(t.children[0]))){if("string"===typeof(p=this.evalExpr(t.children[1])))return f.indexOf(p)+1}else if(c(f)){var p,d=this.evalExpr(t.children[1]);if("string"===typeof d)if("string"===typeof(p=this.evalExpr(t.children[2])))return d.indexOf(p)+1}throw"ERROR: type mismatch for function INSTR"}},this.evalExpr=function(t){var e=t.getType();"EXPRESSION"===e&&(e=(t=t.children[0]).getType());var i=t.getText();if(n("EVAL TYPE = "+e+" TEXT "+i),"STRING"===e)return t.getText();if("NUMBER"===e){var r=t.getText();return c(r)?r:r.indexOf(".")>=0?parseFloat(r):parseInt(r)}var s=t.children[0],a=t.children[1],h=void 0;void 0!==s&&(h=this.evalExpr(s));var o=void 0;if(void 0!==a&&(o=this.evalExpr(a)),"="===i)return h===o;switch(e){case"*":return h*o;case"^":return Math.pow(h,o);case"/":case"\\":return h/o;case"+":return h+o;case"-":return h-o;case"=":return h===o;case">":return h>o;case"<":return h<o;case"<=":return h<=o;case">=":return h>=o;case"<>":return h!=o;case"AND":return h&o;case"OR":return h|o;case"MOD":return h%o;case"UNARY_MINUS":return-h;case"FUNCTION":return this.evalFunction(t);default:return n("VARIABLE: "+i+" expr "+t),this.getValue(t)}},this.last_input_var=0,this.read_statement=function(t,e){for(var n=t.parser.statements[e],i=n.children.length,r=0;r<i;r++){var s=n.children[r];s.text;if(t.data_pointer>t.data.length)throw"ERROR: READ without DATA";var a=t.data[t.data_pointer++].text;t.setValue(s,a)}return e+1},this.input_statement=function(t,e){var n=t.parser.statements[e],i=n.children.length,r=n.children[0].text;t.print_function&&0===t.last_input_var&&(t.print_function(r,!1),t.last_input_var=1);for(var s=t.last_input_var;s<i;s++){var a=n.children[s],h=a.text,o=null;if(t.input_stack.length>0)t.setValue(a,t.input_stack.pop());else{if("$"===h[h.length-1]){if(!t.string_input_function)throw"ERROR: string input function not defined";o=t.string_input_function(r)}else{if(!t.number_input_function)throw"ERROR: number input function not defined";o=t.number_input_function(r)}if(null===o)return t.last_input_var=s,-1;t.setValue(a,o)}}return t.print_function&&t.print_function("",!0),t.last_input_var=0,e+1},this.print_statement=function(t,e){var i=t.parser.statements[e],r=i.children.length;n("PRINTING "+r);for(var s="",a=0;a<r;a++){var h=i.children[a];if("EXPRESSION"===h.getType())s+=t.evalExpr(h);if("DELIMITER"===h.getType())","===h.text&&(s+="   ")}var o=!0;return r>0&&";"===i.children[r-1].text&&(o=!1),t.print_function&&t.print_function(s,o),e+1},this.cls_statement=function(t,e){t.parser.statements[e];return t.clear_function&&t.clear_function(),e+1},this.randomize_statement=function(t,e){var n=t.parser.statements[e],i=t.evalExpr(n.children[0]);if(!c(i))throw"ERROR: RANDOMIZE expects number as argument";return this.random.setSeed(i),e+1},this.assignment_statement=function(t,e){var n=t.parser.statements[e],i=(n.children.length,n.children[0]),r=n.children[1],s=t.evalExpr(r);return t.setValue(i,s),e+1},this.find_label=function(t){var e=this.parser.label_index;if(void 0===e[t])throw"ERROR: goto destination "+t+" not found";return n("NEXT INDEX"+e[t]),e[t]},this.if_statement=function(t,e){var i=t.parser.statements[e],r=i.children.length;n("IF "+r+" "+i.getText());for(var s=0;s<r;s++)n(i.children[s]);var a=i.children[0],h=t.evalExpr(a);if(n(h),h){var o=i.children[1];return t.find_label(o.getText())}var c=i.children[2];return t.find_label(c.getText())},this.goto_statement=function(t,e){var n=t.parser.statements[e].getText();return t.find_label(n)},this.gosub_statement=function(t,e){var n=t.parser.statements[e].getText();if(t.gosub_stack.push(e+1),t.gosub_stack.length>100)throw"ERROR: GOSUB stack exceeded";return t.find_label(n)},this.return_statement=function(t,e){if(0===t.gosub_stack.length)throw"ERROR: RETURN without GOSUB";var i=t.gosub_stack.pop();return n("RETURN TO "+i),i},this.find_next=function(t,e){for(var n=this.parser.statements.length,i=t+1;i<n;i++){var r=this.parser.statements[i];if("NEXT"===r.getType()){if(0===r.children.length)return i;for(var s=r.children.length,a=0;a<s;a++)if(r.children[a].text===e)return i}}throw"ERROR: FOR without NEXT"},this.find_wend=function(t,e){for(var n=this.parser.statements.length,i=t+1;i<n;i++){if("WEND"===this.parser.statements[i].getType())return i}throw"ERROR: while without wend"},this.while_statement=function(t,e){var n=t.parser.statements[e].children[0],i=t.evalExpr(n);if("number"!==typeof i&&"boolean"!==typeof i)throw"ERROR: WHILE expression is not boolean";return i?(t.while_stack.push(e),e+1):t.find_wend(e)+1},this.wend_statement=function(t,e){if(0===t.while_stack.length)throw"ERROR:  WEND without while";t.parser.statements[e];return t.while_stack.pop()},this.for_statement=function(t,e){var i=t.parser.statements[e],r=i.children[0].getText(),s=i.children[1],a=t.evalExpr(s);if("number"!==typeof a)throw"ERROR: FOR expression is not numeric";var h=i.children[2],o=t.evalExpr(h);if("number"!==typeof o)throw"ERROR: TO expression is not numeric";var c=1;if(4===i.children.length){var u=i.children[3];c=t.evalExpr(u)}var l=t.find_next(e,r);if(t.setNumericValue(r,a),a*c>o)return n("SKIPPING LOOP"),l+1;var f={lvar:r,limit:o,step:c,body:e+1};return t.for_info[e]=f,t.for_stack.push(e),n("start execute loop"),e+1},this.next_statement=function(t,e){if(0===t.for_stack.length)throw"ERROR: NEXT without FOR";var i=t.parser.statements[e],r=t.for_stack[t.for_stack.length-1],s=t.for_info[r],a=s.lvar;if(n("NEXT TO "+r),0===i.children.length){if(n("val "+(u=t.getNumericValue(a))+" STEP: "+s.step),n("valnow "+(u+=s.step)),s.step>=0){if(u>s.limit)return t.for_stack.pop(),e+1}else if(u<s.limit)return t.for_stack.pop(),e+1;return t.setNumericValue(a,u),n("back to "+s.body),s.body}for(var h=i.children.length,o=0;o<h;o++){var c=i.children[o].text;if(c===a){var u=t.getNumericValue(a);u+=s.step;var l=!1;if(s.step>=0?u>s.limit&&(l=!0):u<s.limit&&(l=!0),l){if(t.for_stack.pop(),o===h-1)return e+1;if(0===t.for_stack.length)throw"ERROR: NEXT without FOR";r=t.for_stack[t.for_stack.length-1],a=(s=t.for_info[r]).lvar;continue}return t.setNumericValue(a,u),s.body}throw"ERROR: Expected NEXT "+a+" got NEXT "+c}return r},this.end_statement=function(t,e){return t.parser.statements.length+1},this.data_statement=function(t,e){t.parser.statements[e];return e+1},this.dummy_statement=function(t,e){return e+1},this.clear_statement=function(t,e){return this.variables=new Array,e+1},this.dim_statement=function(t,e){n("DIM DIMENSION");for(var i=t.parser.statements[e],r=0;r<i.children.length;r++){var s=i.children[r],a=s.getText();if(n("DIM NAME "+a),a+="[]",void 0===t.variables[a]){var h=new m(a),o=t.get_array_indices(s);n(o),h.setBounds(o),t.variables[a]=h}}return e+1},this.run=function(t){var e=this.parser.statements[t];n("statement: "+e);var i=e.getType();return"LINENUMBER"===i?t+1:void 0!==this.ifunctions[i]?this.ifunctions[i](this,t):t+1},this.resume_input=function(){var t=this.parser.statements.length,e=this.last_point;for(this.stop=!1;!this.stop&&e<t;){var n=this.run(e);if(-1===n){this.last_point=e;break}e=n}this.last_point=e},this.find_line_number=function(t){for(var e=t;e>=0;){var n=this.parser.statements[e];if("LINENUMBER"===n.getType())return n.text;e--}return 0},this.interpret=function(){n("Interpreting");var t=this.parser.statements.length;this.data=new Array,this.data_pointer=0,this.variables=new Array;for(var i=0;i<t;i++){var r=this.parser.statements[i];if("DATA"===r.getType())for(var s=r.children.length,a=0;a<s;a++)this.data.push(r.children[a])}var h=0;if(this.stop=!1,this.last_input_var=0,e=!1){n("CONTENT:-----");for(i=0;i<t;i++)n(i+" -- "+this.parser.statements[i]);n("END OF CONTENT:-----")}for(e=!1;!this.stop&&h<t;){try{var o=this.run(h)}catch(u){var c="LINE "+this.find_line_number(h)+" ";throw c+=u}if(-1===o){this.last_point=h;break}h=o}this.last_point=h},this.setParser=function(t){this.parser=t},this.last_random=this.random.random(),this.ifunctions.PRINT=this.print_statement,this.ifunctions.INPUT=this.input_statement,this.ifunctions.ASSIGNMENT=this.assignment_statement,this.ifunctions.IF=this.if_statement,this.ifunctions.GOTO=this.goto_statement,this.ifunctions.GOSUB=this.gosub_statement,this.ifunctions.RETURN=this.return_statement,this.ifunctions.END=this.end_statement,this.ifunctions.DIM=this.dim_statement,this.ifunctions.FOR=this.for_statement,this.ifunctions.NEXT=this.next_statement,this.ifunctions.WHILE=this.while_statement,this.ifunctions.WEND=this.wend_statement,this.ifunctions.CLS=this.cls_statement,this.ifunctions.RANDOMIZE=this.randomize_statement,this.ifunctions.READ=this.read_statement,this.ifunctions.DATA=this.data_statement,this.ifunctions.KEY=this.dummy_statement,this.ifunctions.CLEAR=this.clear_statement}],w=function(t,e,n,i){if(t.length<=0)return null;var r=Object(h.a)(v,2),s=r[0],a=r[1];try{var o=new s(t);o.parse();var c=new a;c.setParser(o),c.print_function=e;var u=function(t){var e=t();c.push_input(e);try{c.resume_input()}catch(n){console.trace(n)}};return c.string_input_function=function(){return u(n)},c.number_input_function=function(){return u(i)},c.interpret(),"OK"}catch(l){return console.trace(l),l}},x=function(t,e,n){return[function(t){var n=t.target,i=n.name,r=n.value;"terminal"===i&&e(r)},function(n){if(13===n.charCode){var i=t.split("\n"),r=i.length>0?i[i.length-1]:"";if("run"===r.toLowerCase()){for(var s="",a=i.length-1;a>=0&&!i[a].match(/READY/g);a--)s=a===i.length-1?i[a]+s:i[a]+"\n"+s;w(s,(function(t,n){e((function(e){return"".concat(e,"\n").concat(t).concat(n?"\n":"")}))}),(function(){return prompt("Enter input:")}),(function(){var t=prompt("Enter a number:");return parseFloat(t)}));e((function(t){return t+"READY."}))}else"clear"===r.toLowerCase()&&e("")}}]},g=(n(10),n(11),function(){var t=Object(i.useState)(""),e=Object(h.a)(t,2),n=e[0],s=e[1],a=x(n,s),o=Object(h.a)(a,2),c=o[0],u=o[1];return r.a.createElement("main",{className:"frame"},r.a.createElement("header",null,r.a.createElement("h1",{className:"heading"},"**** Commodore 64 ****"),r.a.createElement("h1",{className:"heading"},"64K ram system 38911 basic bytes free")),r.a.createElement("div",{id:"terminal-container"},r.a.createElement("textarea",{spellCheck:"false",type:"text",id:"terminal",name:"terminal",value:n,autoFocus:!0,onChange:function(t){return c(t)},onKeyPress:function(t){return u(t)}})),r.a.createElement("div",{className:"overlay"},"AV-1"))});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a.a.render(r.a.createElement(g,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))}],[[4,1,2]]]);
//# sourceMappingURL=main.303d490a.chunk.js.map